#!/usr/bin/env ruby
# encoding: utf-8

require 'erb'
require 'fileutils'

TMUX_SCRIPTS_FOLDER = File.expand_path('~/.tmuxgen')

PROJECT_PATH = File.expand_path(ARGV[0])
PROJECT_NAME = File.basename(PROJECT_PATH).gsub('.', '-')

def print_help
  puts """
  tmuxgen A tmux script generator

  Usage:
    tmuxgen folder_path --flag

    --flag: the type of template to render, options are: --rails, --ruby or --go
  """
end

def render_template(template_name)
  puts "Project path: #{PROJECT_PATH}"
  puts "Project name: #{PROJECT_NAME}"

  template = File.read(File.expand_path("#{TMUX_SCRIPTS_FOLDER}/templates/#{template_name}.erb"))
  renderer = ERB.new(template)
  filename = "#{TMUX_SCRIPTS_FOLDER}/#{PROJECT_NAME}-tmux"
  File.write(filename, renderer.result)
  FileUtils.chmod('+x', filename)
end


case ARGV[1]
when '--rails'
  render_template("rails")
when '--ruby'
  render_template("ruby")
when '--go'
  render_template("go")
else
  print_help
end
